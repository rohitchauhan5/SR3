set.seed(1)
m <- 200
n <- 1000
# m <- 2
# n <- 10
k <- 10
sigma <- 1e-1
A <- matrix(c(rnorm(m * n)), m, n, byrow = TRUE)

# A <- matrix(c(1.21922989487676,	1.24585211982407,	0.238719793624606,	0.202568919408296,	0.157782682674033,	0.911194253681757,	-0.737570854133908,	0.730233773288473,	-0.308759070162731,	0.851314148774770,
# 0.0589493740431605,	-0.503662882729686,	-0.0328837158914363,	1.11396451128702,	-0.967377000461243,	-0.850627348988889,	0.467480818368008,	0.255763973951610,	-0.622414779574672,	-0.115786625605641), 2, 10, byrow=TRUE)

y <- matrix(0, n, 1, byrow = TRUE)

# MATLAB ind = randperm(n,k);
ind <- sample(1:n, k, replace = FALSE)

# MATLAB y(ind) = sign(randn(k,1));
y[ind] <- sign(rnorm(k))

# (200, 1000) x (1000, 1) + 200
b <- A %*% y + sigma * rnorm(m)

lam1 <- 0.01
lam0 <- 0.004

results <- sr3(A, b, mode = '0', lam = lam0)
results <- sr3(A, b, lam = lam1)

xl2 <- qr.solve(A, b)
